{"version":3,"sources":["./src/app/+calculation/loadflow/loadflow-routing.module.ts","./src/app/+calculation/loadflow/loadflow.component.css","./src/app/+calculation/loadflow/loadflow.component.html","./src/app/+calculation/loadflow/loadflow.component.ts","./src/app/+calculation/loadflow/loadflow.module.ts","./src/app/components/load-flow-parameters-form/load-flow-parameters-form.component.css","./src/app/components/load-flow-parameters-form/load-flow-parameters-form.component.html","./src/app/components/load-flow-parameters-form/load-flow-parameters-form.component.ts"],"names":[],"mappings":"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","file":"loadflow.module.chunk.js","sourcesContent":["import { NgModule } from '@angular/core';\nimport { Routes, RouterModule } from '@angular/router';\nimport { LoadFlowComponent } from \"app/+calculation/loadflow/loadflow.component\";\n\nconst routes: Routes = [{\n  path: '',\n  component: LoadFlowComponent,\n}];\n\n@NgModule({\n  imports: [RouterModule.forChild(routes)],\n  exports: [RouterModule]\n})\nexport class LoadFlowRoutingModule { }\n\n\n\n// WEBPACK FOOTER //\n// ./src/app/+calculation/loadflow/loadflow-routing.module.ts","module.exports = \".column-group-g {\\n    background-color: #1b6d85;\\n}\\n.column-group-c {\\n    background-color: #67b168;\\n}\\n.custom-file-download {\\n    border: none;\\n    padding: 0;\\n    background: none;\\n  \\n}\\n.rag-red {\\n    background-color: lightcoral;\\n}\\n.rag-green {\\n    background-color: lightgreen;\\n}\\n\"\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/app/+calculation/loadflow/loadflow.component.css\n// module id = ./src/app/+calculation/loadflow/loadflow.component.css\n// module chunks = loadflow.module","module.exports = \"<!-- MAIN CONTENT -->\\n\\n  <div *ngIf=\\\"show;else othercontent\\\" id=\\\"content\\\">\\n\\n    <div class=\\\"row\\\">\\n      <!-- <sa-big-breadcrumbs [items]=\\\"['Load Flow Calculation']\\\" icon=\\\"table\\\" class=\\\"col-xs-12 col-sm-7 col-md-7 col-lg-4\\\"></sa-big-breadcrumbs> -->\\n      <sa-big-breadcrumbs [items]=\\\"['Load Flow Calculation']\\\" icon=\\\"table\\\" class=\\\"col-xs-12 col-sm-7 col-md-7 col-lg-4\\\"></sa-big-breadcrumbs>\\n      <!-- <sa-stats></sa-stats> -->\\n    </div>\\n\\n    <load-flow-parameters-form (change) = \\\"executeLoadFlow()\\\" ></load-flow-parameters-form>\\n    <button *ngIf=\\\"showButton\\\" class=\\\"custom-file-download\\\" id=\\\"file-download\\\" (click)=\\\"export()\\\" > <i class=\\\"fa fa-cloud-download\\\"></i> Export Results (Excel) </button>\\n    <!-- widget grid -->\\n    <sa-widgets-grid>\\n\\n\\n      <div class=\\\"row\\\">\\n        <article class=\\\"col-sm-12\\\">\\n          <div class=\\\"table-responsive\\\" style=\\\"width: 100%; height: 500px;\\\">\\n            <ag-grid-angular #agGrid style=\\\"width: 100%;height: 50%;\\\" class=\\\"ag-fresh\\\" [gridOptions]=\\\"gridOptionsBusbars\\\" [rowData]=\\\"rowDataBusbars\\\"  >\\n              \\n              <!--  [columnDefs]=\\\"columnDefs\\\" [defaultColDef]=\\\"defaultColDef\\\" -->\\n            </ag-grid-angular>\\n\\n            \\n\\n            <ag-grid-angular #agGrid style=\\\"width: 100%;height: 50%;\\\" class=\\\"ag-fresh\\\" [gridOptions]=\\\"gridOptionsBranches\\\" [rowData]=\\\"rowDataBranches\\\" >\\n            \\n            </ag-grid-angular>\\n          \\n          </div>\\n\\n          <!--\\n          <sa-widget [editbutton]=\\\"false\\\" color=\\\"darken\\\">\\n            <header>\\n              <span class=\\\"widget-icon\\\">\\n                <i class=\\\"fa fa-table\\\"></i>\\n              </span>\\n\\n              <h2>Load Flow results</h2>\\n            </header>\\n            <div>\\n              <div class=\\\"widget-body no-padding\\\">\\n                 <alert type=\\\"info\\\" class=\\\"no-margin fade in\\\" dismisser=\\\"\\\"> \\n                <i class=\\\"fa-fw fa fa-info\\\"></i>\\n                Adds zebra-striping to table row within <code>&lt;table&gt;</code> by adding the <code>.table-striped</code>\\n                with the base class\\n              </alert>\\n           \\n            \\n\\n              </div>\\n            </div>\\n          </sa-widget>\\n           -->\\n        </article>\\n\\n\\n      </div>\\n\\n    </sa-widgets-grid>\\n  </div>\\n\\n <ng-template #othercontent>Please open or create project in the Home tab first</ng-template>\"\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/app/+calculation/loadflow/loadflow.component.html\n// module id = ./src/app/+calculation/loadflow/loadflow.component.html\n// module chunks = loadflow.module","import { ShowDataService } from 'app/services/show-data.service';\nimport { Component, Inject } from '@angular/core';\nimport { HttpClient, HttpErrorResponse} from \"@angular/common/http\";\n\nimport { GridOptions } from \"ag-grid/main\";\n\nimport * as XLSX from 'xlsx';\nimport { ProjectService } from '../../services/project.service';\n\n@Component({\n    templateUrl: './loadflow.component.html',\n    styleUrls: ['./loadflow.component.css']\n})\n\n\nexport class LoadFlowComponent {\n\n    public loadflow: LoadFlow[] = [];\n\n    gridOptionsBusbars: GridOptions;\n    gridOptionsBranches: GridOptions;\n    rowDataBusbars: any; //było any[]\n    rowDataBranches: any; //było any[]\n    show: boolean;\n    showButton: boolean;\n    //headers = new HttpHeaders().set('Content-Type', 'application/json; charset=utf-8');\n\n    // showResult: boolean = false;\n\n  \n    constructor(public http: HttpClient, public showData: ShowDataService, private projectService: ProjectService) { //@Inject('BASE_URL') baseUrl: string,\n        //  this.rowData = JSON.parse(localStorage.getItem('dane'));\n        this.showButton = false;\n        //this.showResult = false;\n        //czy pokazywać dane czy nie w zależności od tego czy projekt jest otwarty\n        this.showData.currentShow.subscribe(show => this.show = show);\n\n        // we pass an empty gridOptions in, so we can grab the api out\n        this.gridOptionsBusbars = <GridOptions>{\n            onGridReady: () => {\n                this.gridOptionsBusbars.api.sizeColumnsToFit(); //make the currently visible columns fit the screen.\n                this.gridOptionsBusbars.api.setRowData([]);\n                // show 'no rows' overlay              \n            },\n        };\n\n        this.gridOptionsBranches = <GridOptions>{\n            onGridReady: () => {\n                this.gridOptionsBranches.api.sizeColumnsToFit(); //make the currently visible columns fit the screen.\n                // show 'no rows' overlay              \n            },\n        };\n\n        this.gridOptionsBusbars = {\n            // singleClickEdit: false,\n            stopEditingWhenGridLosesFocus: true,\n            overlayLoadingTemplate: '<span class=\"ag-overlay-loading-center\">Please click \"Calculate\" button to see results </span>',\n            enableSorting: true,\n            enableFilter: true,\n            enableColResize: true,\n\n            animateRows: true,\n            rowSelection: 'multiple',\n            columnDefs: [\n                // put the three columns into a group\n                {\n                    headerName: 'Results - busbars',\n                    groupId: \"LF_Busbars\",\n                    children: [\n\n                        {\n                            headerName: \"Bus no.\", field: \"busNo\", type: \"numericColumn\"\n                        },\n                        {\n                            headerName: \"Voltage [kV]\", field: \"resultU\", type: \"numericColumn\", valueFormatter: this.numberFormatter\n                            /*,  valueParser: this.numberParser */\n                        },\n                        {\n                            headerName: \"Voltage [pu]\", field: \"resultUpu\", type: \"numericColumn\", valueFormatter: this.numberFormatter,\n\n                            cellStyle: function (params) {\n                                if (params.value > '0.95' && params.value < '1.05') {\n                                    return { backgroundColor: 'lightgreen' };\n                                }\n                                if ((params.value > '0.9' && params.value <= '0.95') || (params.value >= '1.05' && params.value < '1.1')) {\n                                    return { backgroundColor: 'lightsalmon' };\n                                }\n                                if (params.value <= '0.9' || params.value >= '1.1') {\n                                    return { backgroundColor: 'lightcoral' };\n                                }\n                            }\n\n                        },\n                        {\n                            headerName: \"Angle [degrees]\", field: \"resultSigma\", type: \"numericColumn\", valueFormatter: this.numberFormatter\n                        },\n\n                    ]\n                },\n            ],\n        }\n\n        this.gridOptionsBranches = {\n            // singleClickEdit: false,\n            stopEditingWhenGridLosesFocus: true,\n            overlayLoadingTemplate: '<span class=\"ag-overlay-loading-center\">Please click \"Calculate\" button to see results </span>',\n            enableSorting: true,\n            enableFilter: true,\n            enableColResize: true,\n\n            animateRows: true,\n            rowSelection: 'multiple',\n            columnDefs: [\n                // put the three columns into a group                               \n                {\n                    headerName: 'Results - branch elements',\n                    groupId: \"LF_Branches\",\n                    children: [\n                        {\n                            headerName: \"Start bus number\", field: \"busNoStart\", type: \"numericColumn\", columnGroupShow: 'open'\n                        },\n                        {\n                            headerName: \"End bus number\", field: \"busNoEnd\", type: \"numericColumn\", columnGroupShow: 'open'\n                        },\n                        {\n                            headerName: \"Active power loss [MW]\", field: \"resultPloss\", type: \"numericColumn\", columnGroupShow: 'open', valueFormatter: this.numberFormatter\n                        },\n                        {\n                            headerName: \"Reactive power loss [MVar]\", field: \"resultQloss\", type: \"numericColumn\", columnGroupShow: 'open', valueFormatter: this.numberFormatter\n                        },\n                        {\n                            headerName: \"Current Iij [kA]\", field: \"resultIload_i\", /*width: 100,*/ type: \"numericColumn\", columnGroupShow: 'open', valueFormatter: this.numberFormatter\n                        },\n                        {\n                            headerName: \"Current Iji [kA]\", field: \"resultIload_j\", /*width: 100,*/ type: \"numericColumn\", columnGroupShow: 'open', valueFormatter: this.numberFormatter\n                        },\n                    ]\n                }\n            ],\n        }\n    }\n    /*\n\n    intercept(request: HttpRequest<any>, next: HttpHandler): Observable<HttpEvent<any>> {\n\n        return next.handle(request).do((event: HttpEvent<any>) => {}, (err: any) => {\n          if (err instanceof HttpErrorResponse) {\n            // do error handling here\n           \n          }\n        });\n      }\n*/\n\n\n    numberFormatter(params) {\n\n        var result: number;\n\n        //w przypadku bardzo małych liczb wyświetla wartość 0 \n        if (params.value > -0.00000000001 && params.value < 0.00000000001) {\n            result = 0;\n            return result.toFixed(3);\n\n        }\n        else {\n            return params.value.toFixed(3); //zaokragla do trzeciej liczby po przecinku\n            /*\n            Math.floor(params.value)\n            .toString()\n            .replace(/(\\d)(?=(\\d{3})+(?!\\d))/g, \"$1,\");\n            */\n        }\n\n\n    }\n    /*\n  formatNumber(number) {\n      return Math.floor(number)\n        .toString()\n        .replace(/(\\d)(?=(\\d{3})+(?!\\d))/g, \"$1,\");\n  } */\n\n    /*\n   numberParser(params) { \n        return Number(params.newValue);\n      }*/\n\n\n    projectId: number;\n    executeLoadFlow() {\n        //obserwuj ID projektu, który jest otwarty, żeby na tej podstawie wczytywać dane\n        this.projectService.currentProjectId.subscribe(projectId => this.projectId = projectId);\n        this.http.get('api/LoadFlow/Calculate/' + this.projectId).subscribe(result => {\n            this.rowDataBusbars = result; //as LoadFlow[]\n            this.rowDataBranches = result;\n            this.showButton = true;\n            \n        },\n        error => {\n            alert(\"Something went wrong. Please verify data and try again. Please contact electrisim@electrisim.com for support\");\n        }  \n    );\n\n    }\n    //zaktualizowanie tabeli\n    printResult(res) {\n        console.log('---------------------------------------')\n        if (res.add) {\n            res.add.forEach(function (rowNode) {\n\n                console.log('Added Row Node', rowNode);\n            });\n        }\n        if (res.remove) {\n            res.remove.forEach(function (rowNode) {\n                console.log('Removed Row Node', rowNode);\n            });\n        }\n        if (res.update) {\n            res.update.forEach(function (rowNode) {\n                console.log('Updated Row Node', rowNode);\n            });\n        }\n    }\n    //zbierz dane z serwera i zapisz do pliku xlsx\n    export(): void {\n        \n\n        const ws: XLSX.WorkSheet = XLSX.utils.json_to_sheet(this.rowDataBusbars);\n\n        // generate workbook and add the worksheet \n        const wb: XLSX.WorkBook = XLSX.utils.book_new();\n        XLSX.utils.book_append_sheet(wb, ws, 'Sheet1');\n\n        /* save to file */\n        //XLSX.writeFile(wb, 'externalgrid_'+this.projectName+'.xlsx');\n        XLSX.writeFile(wb, 'bus_results_.xlsx');//' + this.projectName + '.xlsx');\n\n        const wsheet: XLSX.WorkSheet = XLSX.utils.json_to_sheet(this.rowDataBranches);\n\n        // generate workbook and add the worksheet \n        const wbook: XLSX.WorkBook = XLSX.utils.book_new();\n        XLSX.utils.book_append_sheet(wb, ws, 'Sheet2');\n\n        /* save to file */\n        //XLSX.writeFile(wb, 'externalgrid_'+this.projectName+'.xlsx');\n        XLSX.writeFile(wb, 'branch_results_.xlsx');//' + this.projectName + '.xlsx');\n    }\n}\n\ninterface LoadFlow {\n    busNo: number;\n    resultU: number;\n    resultUpu: number;\n    resultSigma: number;\n\n    busNoStart: number;\n    busNoEnd: number;\n    resultPloss: number;\n    resultQloss: number;\n    resultIload_i: number;\n    resultIload_j: number;\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/app/+calculation/loadflow/loadflow.component.ts","import { NgModule, Injectable } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { HttpClientModule } from '@angular/common/http';\n\nimport { LoadFlowRoutingModule } from './loadflow-routing.module';\nimport { LoadFlowComponent } from \"app/+calculation/loadflow/loadflow.component\";\nimport {SmartadminModule} from \"app/shared/smartadmin.module\";\nimport {LoadFlowParametersFormComponent} from \"app/components/load-flow-parameters-form/load-flow-parameters-form.component\";\n\nimport {AgGridModule} from 'ag-grid-angular/main';\nimport { ReactiveFormsModule } from '@angular/forms';\n\n@NgModule({\n  imports: [\n    CommonModule,\n    HttpClientModule,\n    SmartadminModule,\n    AgGridModule.withComponents([]),\n    LoadFlowRoutingModule,\n    ReactiveFormsModule\n    \n  ],\n  declarations: [\n    LoadFlowComponent,\n    LoadFlowParametersFormComponent\n  ],\n  providers: [\n    { provide: 'BASE_URL', useFactory: getBaseUrl }\n  ] \n})\nexport class LoadFlowModule { }\n\nexport function getBaseUrl() {\n  return document.getElementsByTagName('base')[0].href;\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/app/+calculation/loadflow/loadflow.module.ts","module.exports = \".box{\\n    border: solid 1px #000;\\n    padding: 10px;\\n    text-align:center;\\n  }\\n\\n  \\n\"\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/app/components/load-flow-parameters-form/load-flow-parameters-form.component.css\n// module id = ./src/app/components/load-flow-parameters-form/load-flow-parameters-form.component.css\n// module chunks = loadflow.module","module.exports = \"<button type=\\\"button\\\" class=\\\"btn btn-primary\\\" (click)=\\\"openModal(template)\\\" style=\\\"margin-top: 10px; margin-bottom: 10px\\\">\\n  Calculate</button>\\n\\n<ng-template #template>\\n  <div class=\\\"modal-header\\\">\\n    <h4 class=\\\"modal-title pull-left\\\">Load Flow Parameters</h4>\\n    <button type=\\\"button\\\" class=\\\"close pull-right\\\" aria-label=\\\"Close\\\" (click)=\\\"modalRef.hide()\\\">\\n      <span aria-hidden=\\\"true\\\">&times;</span>\\n    </button>\\n  </div>\\n  <div class=\\\"modal-body\\\">\\n\\n    <div class=\\\"bs-example\\\">\\n      <ul class=\\\"nav nav-tabs\\\">\\n        <li class=\\\"active\\\">\\n          <a data-toggle=\\\"tab\\\" href=\\\"#sectionA\\\">Basic Description</a>\\n        </li>\\n\\n        <li class=\\\"dropdown\\\">\\n          <a data-toggle=\\\"dropdown\\\" class=\\\"dropdown-toggle\\\" href=\\\"#\\\">Iteration control\\n            <b class=\\\"caret\\\"></b>\\n          </a>\\n          <ul class=\\\"dropdown-menu\\\">\\n            <li>\\n              <a data-toggle=\\\"tab\\\" href=\\\"#dropdown1\\\">Max. number of iterations for:</a>\\n            </li>\\n            <li>\\n              <a data-toggle=\\\"tab\\\" href=\\\"#dropdown2\\\">Max. acceptable load flow error for:</a>\\n            </li>\\n          </ul>\\n        </li>\\n      </ul>\\n\\n\\n      <div class=\\\"tab-content\\\">\\n        <div id=\\\"sectionA\\\" class=\\\"tab-pane fade in active\\\">\\n          <p>AC Load Flow, balanced, positive sequence</p>\\n          <p>Newton-Raphson method</p>\\n        </div>\\n        <div id=\\\"dropdown1\\\" class=\\\"tab-pane fade\\\">\\n          <h3>Max. number of iterations for:</h3>\\n          <form [formGroup]=\\\"form\\\" (ngSubmit)=\\\"saveAndExecute()\\\" class=\\\"form-horizontal\\\">\\n            <div *ngIf=\\\"form.errors\\\" class=\\\"alert alert-danger\\\">At least one input parameter is invalid </div>\\n\\n            <div formGroupName=\\\"iteration\\\">\\n              <div class=\\\"form-group\\\">\\n                <label for=\\\"iterNR\\\">Newton-Raphson iteration:</label>\\n                <input formControlName=\\\"iterNR\\\" type=\\\"text\\\" class=\\\"form-control\\\" id=\\\"iterNR\\\">\\n                <div *ngIf=\\\"iterNR.touched && iterNR.invalid\\\" class=\\\"alert alert-danger\\\">It is required</div>\\n              </div>\\n              <div class=\\\"form-group\\\">\\n                <label for=\\\"outIter\\\">Outer loop</label>\\n                <input formControlName=\\\"outIter\\\" type=\\\"text\\\" class=\\\"form-control\\\" id=\\\"outIter\\\">\\n                <div *ngIf=\\\"outIter.touched && outIter.invalid\\\" class=\\\"alert alert-danger\\\">It is required</div>\\n              </div>\\n              <div class=\\\"form-group\\\">\\n                <label for=\\\"steps\\\">Number of steps</label>\\n                <input type=\\\"text\\\" class=\\\"form-control\\\" id=\\\"steps\\\" value=\\\"1\\\">\\n              </div>\\n            </div>\\n            <!--\\n            <button type=\\\"submit\\\" class=\\\"btn btn-default\\\">Execute</button>\\n            -->\\n          </form>\\n        </div>\\n        <div id=\\\"dropdown2\\\" class=\\\"tab-pane fade\\\">\\n          <h2>Max. acceptable load flow error for:</h2>\\n          <form class=\\\"form-horizontal\\\">\\n\\n\\n            <div class=\\\"form-group\\\">\\n              <label for=\\\"errNodes\\\">Nodes</label>\\n              <input type=\\\"text\\\" class=\\\"form-control\\\" id=\\\"errNodes\\\" value=\\\"1\\\">\\n            </div>\\n            <div class=\\\"form-group\\\">\\n              <label for=\\\"errorModelEquations\\\">Model Equations [kVA]</label>\\n              <input type=\\\"text\\\" class=\\\"form-control\\\" id=\\\"errorModelEquations\\\" value=\\\"0,1\\\">\\n\\n            </div>\\n            <!--<button type=\\\"submit\\\" class=\\\"btn btn-default\\\">Submit</button>-->\\n          </form>\\n        </div>\\n\\n      </div>\\n    </div>\\n\\n  </div>\\n\\n  <div class=\\\"modal-footer\\\">\\n    <button type=\\\"button\\\" class=\\\"btn btn-default\\\" (click)=\\\"modalRef.hide()\\\">Close</button>\\n    <button type=\\\"submit\\\" class=\\\"btn btn-primary\\\" (click)=\\\"saveAndExecute()\\\">Execute</button>\\n   \\n  </div>\\n</ng-template>\"\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/app/components/load-flow-parameters-form/load-flow-parameters-form.component.html\n// module id = ./src/app/components/load-flow-parameters-form/load-flow-parameters-form.component.html\n// module chunks = loadflow.module","import { LoadFlowComponent } from 'app/+calculation/loadflow/loadflow.component';\nimport { FormGroup, FormControl, Validators } from '@angular/forms';\n\nimport { ShowDataService } from './../../services/show-data.service';\nimport { ProjectService } from './../../services/project.service';\nimport { Component, OnInit, Output, EventEmitter, TemplateRef } from '@angular/core';\nimport { AuthService } from 'app/services/auth/auth.service';\nimport { BsModalService } from 'ngx-bootstrap/modal';\nimport { BsModalRef } from 'ngx-bootstrap/modal/bs-modal-ref.service';\nimport { HttpClient, HttpHeaders } from \"@angular/common/http\";\n\n\n\n@Component({\n  selector: 'load-flow-parameters-form',\n  templateUrl: './load-flow-parameters-form.component.html',\n  styleUrls: ['./load-flow-parameters-form.component.css']\n})\nexport class LoadFlowParametersFormComponent implements OnInit {\n\n  @Output() change = new EventEmitter();\n\n  projects: any[];\n  deletedProject: any = {};\n  selectedProject: any = [];\n  modalRef: BsModalRef;\n  headers = new HttpHeaders().set('Content-Type', 'application/json; charset=utf-8');\n\n  form = new FormGroup({\n    iteration: new FormGroup({\n      iterNR: new FormControl('25', [Validators.required]),\n      outIter: new FormControl('20', Validators.required)\n    })\n  });\n\n  get iterNR() {\n    return this.form.get('iteration.iterNR');\n  }\n\n  get outIter() {\n    return this.form.get('iteration.outIter');\n  }\n\n\n\n  constructor(public http: HttpClient, private projectService: ProjectService, private auth: AuthService, private modalService: BsModalService, private showData: ShowDataService) {\n\n  }\n\n\n  ngOnInit() {\n\n  }\n\n  saveAndExecute() {\n\n    this.form.setErrors({\n      invalidLogin: true\n    });\n\n\n    //wykonaj Execute z loadflow.component\n    this.change.emit();\n\n    //schowaj ramke\n    this.modalRef.hide();\n  }\n\n\n\n\n\n  openModal(template: TemplateRef<any>) {\n\n    this.modalRef = this.modalService.show(template);\n  }\n\n}\n\n\n\n\n// WEBPACK FOOTER //\n// ./src/app/components/load-flow-parameters-form/load-flow-parameters-form.component.ts"],"sourceRoot":"webpack:///"}